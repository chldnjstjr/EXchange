---
title: "S3_Visualization"
author: "WS CHOI"
date: '`r Sys.Date()`'
output: html_document
---

# 소개

이 보고서는 환줌마, 환저씨, 환친자, 환친새끼들에게 바치는 보고서이며 환승연애3의 출연자 관계와 감정을 더 잘 이해하기 위한 목적으로 작성되었읍니다.

객관성을 갖추기 위해 노력했으나 환승연애 시청 시 특성 상 감정이입이 될 수 밖에 없읍니다. 이에 데이터를 편집하는 과정에서 왜곡이 상당히 심하게 이루어졌을 수 있음을 감안해주시면 정말 감안하겠읍니다.

아래 소개될 자료들에 대한 반박 시 당신의 말이 100% 맞음을 잊지 말아주시길 바라겠읍니다.

# 글쓴이 약력

-   환승연애 경력 3년차

    -   환승연애 1 빨리감기 정주행 1회

    -   환승연애 2 정주행 2회

    -   환승연애 3 정주행 중

-   솔로지옥 1\~3 정주행

-   하트시그널 2 김현우-오영주 유튜브 클립 정주행

# 데이터 불러오기

## googlesheets4

-   googlesheets4 패키지를 이용하여 구글 스프레드시트의 데이터 불러오기

```{r}
library(googlesheets4)

# Load the data
gs4_deauth()
```

-   데이터는 구글스프레드시트에서 직접 편집하였습니다.

```{r, warning=FALSE}
url <- "https://docs.google.com/spreadsheets/d/145u9yNb2bUUDG_H8Jg-8fg7XZFUquiY9dWmor7ug7N0/edit?usp=sharing"

s3_data <- read_sheet(url)
s3_orin <- s3_data
#s3_data <- s3_orin
```

```{r, warning=FASLSE}
library(dplyr)

# s3_data에서 "FROM" 열을 제외하여 업데이트
s3_data <- s3_data %>% select(-FROM)

#s3_data의 열 이름을 행 이름으로 설정
rownames(s3_data) <- colnames(s3_data)

# 데이터 프레임을 행렬로 변환
matrix_data <- as.matrix(s3_data)

# 결과 출력
print(matrix_data)
```

# 관계 시각화 1: Chord Diagram

## chordddiag

-   chord diagram은 관계를 시각화 하는 데 사용되는 그래프입니다.
-   chorddiag 패키지를 이용하여 chord diagram을 그릴 수 있습니다.

```{r, warning=FALSE}
#install.packages("devtools")
#library(devtools)
#devtools::install_github("mattflor/chorddiag", build_vignettes = TRUE)
library(chorddiag)
```

```{r, warning=FALSE}
# 사용자 정의 색상 지정
groupColors <- RColorBrewer::brewer.pal(12, "Set3")

# 코디어그램 생성
p <- chorddiag(matrix_data, groupColors = groupColors, groupnamePadding = 20)

# HTML 위젯으로 코디어그램 출력
# 이 부분은 RStudio의 Viewer 패널이나 웹 브라우저에서 확인 가능
p
```

# 텍스트 시각화 1: X편지

## 데이터 불러오기

```{r, warning=FALSE}
# 공유 가능한 URL을 사용하여 스프레드시트 데이터 불러오기

library(stringr)
library(KoNLP) 
library(wordcloud2)

url_mt <- "<https://docs.google.com/spreadsheets/d/168GPtSqLCr81j3yArZNpv2tecLNcnfZyRiMcWQ5zlPE/edit?usp=sharing>" 

df_mt <- read_sheet(url_mt)

df_mt$Value <- as.character(df_mt$Value)

df_mt <- as_tibble(df_mt)
```

## 전처리

-   bitNLP 라이브러리를 사용하여 형태소 분석을 수행합니다([Click](https://r2bit.com/bitNLP/)).

```{r, warning=FALSE}
remotes::install_github("bit2r/bitNLP")
library("bitNLP")
install_mecab_ko()
#install.packages("RcppMeCab")
```

```{r 속마음편지 전처리, warning=FALSE}
#특수문자 제거: 문자 혹은 공백 이외 것 제거 
df_mt <- df_mt %>% mutate(Value = str_remove_all(Value, "[^(\\w+|\\s)]"))

df_mt$Value <- enc2utf8(df_mt$Value)

library(tidytext) 

#단어 단위로 분리
df_mt <- df_mt %>% 
  unnest_tokens(word, Value, "words")

df_mt %>% 
  count(word, sort = TRUE) %>%
  head(10) %>%
  wordcloud2()


#두 글자 이상만 남기기 
df_mt <- df_mt %>% filter(str_count(word) > 1)


```

## 여성 출연자

### 혜원

-   편지 전문

    혜원이는 바라보기만 해도 기분이 좋아지는 미소를 가진 사람입니다. 첫인상은 참 따뜻하고 포근한데 성격은 더 따뜻하고 포근해요. 하나부터 열까지 남자친구에게 맞춰줬으며 싫은 소리 한 번 한 적 없습니다. 그런 혜원이가 화가 나거나 짜증이 났다는 건 정말 잘못했다는 거니까 싹싹 비셔야 할 거예요. 그리고 혜원이는 애정 표현과 칭찬을 정말 많이, 자주 해줘요. 그래서 같이 있으면 제가 참 괜찮은 사람처럼 느껴지게 해주죠. 실제로 혜원이 덕분에 자존감이 많이 올랐거든요.

    혜원이는 말 험하게 하는 걸 싫어해요. 욕하는 건 더더욱 안되고요. 근데 혜원이가 워낙 말을 예쁘게 하는 사람이라 같이 있다 보면 자연스레 물들어서 말을 예쁘게 하고 있을 거예요. 혜원이는 꼭 특별한 걸 같이 하지 않아도 잠깐 얼굴 보는 것만으로도 참 좋아해 줬어요. 사소한 것에도 크게 감동하고 고마워해 주는 사람인데 저는 그 사소한 것마저도 많이 해주지 못해서 참 마음 아프고 미안해요.

    혜원이가 이곳에서 상처받지 않고 좋은 추억만 가져갈 수 있었으면 좋겠어요. 이제는 혜원이가 기댈 수 있을 정도로 여유 있고, 단단하고, 멋있는 사람을 만났으면 좋겠습니다.

-   워드클라우드

```{r Wordcloud_HW, warning=FALSE}
# 혜원이 편지 워드클라우드

```

-   Chat GPT

    휘현이가 작성한 글을 통해 그의 심리 상태를 평가해보자면, 휘현은 혜원에 대한 감정이 매우 긍정적이며, 그녀를 매우 소중하게 여기는 것으로 보입니다. 휘현은 혜원의 성격과 행동을 세심하게 관찰하고, 그녀의 긍정적인 측면을 매우 높이 평가하며 이를 자세히 설명하고 있습니다. 혜원에 대한 존중과 애정이 글에서 뚜렷하게 드러납니다.

    휘현은 혜원이 자신에게 미치는 긍정적인 영향에 대해서도 인지하고 있으며, 그녀 덕분에 자신의 자존감이 향상되었다고 언급합니다. 이러한 부분은 혜원을 대하는 휘현의 감사함과 그녀에 대한 깊은 애정을 보여줍니다. 휘현이 혜원을 얼마나 존중하고 소중하게 여기는지에 대한 강한 증거입니다.

    또한, 휘현은 혜원이 상처받지 않고 좋은 추억만 가져가길 바라며, 그녀에게 더 나은 미래를 바라는 마음을 표현합니다. 이는 휘현이 혜원에 대해 느끼는 감정이 단순한 애정을 넘어 진정으로 그녀의 행복을 바라는 순수한 마음에서 비롯된 것임을 보여줍니다.

    휘현의 글은 혜원에 대한 깊은 애정과 존중, 그리고 그녀의 행복을 진심으로 바라는 마음을 담고 있습니다. 이는 휘현이 혜원과의 관계를 소중히 여기며, 그녀에 대해 매우 긍정적이고 따뜻한 감정을 가지고 있음을 보여줍니다.

### 다혜

### 서경

### 유정

### 상정

### 종은

## 남성 출연자

### 휘현

### 동진

### 주원

### 창진

### 민형

### 광태

# 텍스트 시각화 2: 속마음 메세지

# 설문조사 결과

## 각 출연자들에 대한 여론

### 이어졌으면 하는 커플은?

-   14화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

-   15화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

### 이어지지 않았으면 하는 커플은?

-   14화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

-   15화 공개 후 - 2024년 3월 00일 ㄱㄱ요일
