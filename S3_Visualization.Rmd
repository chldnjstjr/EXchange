---
title: "환승연애3 심층 분석 보고서 1.0"
author: "WS CHOI"
date: '`r Sys.Date()`'
output: 
  prettydoc::html_pretty:
    theme: cayman
    toc: yes
---

# 소개

본 보고서는 환줌마, 환저씨, 환친자, 환친새끼들에게 바치는 것으로 환승연애3의 출연자 관계와 감정을 더 잘 이해하기 위한 목적으로 작성되었읍니다.

객관성을 갖추기 위해 노력했으나 환승연애라는 프로그램의 특성 상 주관적인 감정이입이 될 수 밖에 없읍니다. 이에 데이터를 편집하는 과정에서 왜곡이 상당히 심하게 이루어졌을 수 있음을 감안해주시면 정말 감안하겠읍니다.

아래 소개될 자료들에 대한 반박 시 당신의 말이 100% 맞음을 잊지 말아주시길 바라겠읍니다.

다른 아이디어 및 의견이 있으면 무엇이든 말씀해주시면 보고서에 반영하도록 하겠습니다. 또한 환승연애 3 마지막회까지 본 보서를 함께 작성해줄 집필진을 모집하고 있읍니다. 관심있는 분께서는 [wschoi\@gallup.co.kr로](mailto:wschoi@gallup.co.kr로){.email} 아래 제 약력과 같이 간단히 자신을 소개하는 약력과 함께 연락주시길 바랍니다.

# 글쓴이 약력

-   환승연애 프로그램 시청 경력 3년차

    -   환승연애 1 빨리감기 정주행 1회

    -   환승연애 2 정주행 2회

    -   X편지 낭독 장면 눈물 3회

    -   희두-나연 재회 예측 성공 1회

    -   환승연애 3 정주행 중

    -   "자기야 미안해 했잖아? 그러면 환승연애 이딴거 안나왔어" 장면에서 도파민 100% 분출 1회

    -   환승연애 OST Cover 가능

        -   해가 될까(WOODZ) cover 가능

        -   What if(빅톤 강승식) cover 가능

-   솔로지옥 1\~3 정주행

-   하트시그널 2 김현우-오영주 유튜브 클립 정주행

# 관계도: Chord Diagram

## 데이터 불러오기 (googlesheets4)

-   googlesheets4 패키지를 이용하여 구글 스프레드시트의 데이터 불러오기

```{r}
library(googlesheets4)

# Load the data
gs4_deauth()
```

-   데이터는 구글스프레드시트에서 직접 편집하였습니다.

```{r, warning=FALSE}
url <- "https://docs.google.com/spreadsheets/d/145u9yNb2bUUDG_H8Jg-8fg7XZFUquiY9dWmor7ug7N0/edit?usp=sharing"

s3_data <- read_sheet(url)
s3_orin <- s3_data
#s3_data <- s3_orin
```

```{r, warning=FALSE}
library(dplyr)

# s3_data에서 "FROM" 열을 제외하여 업데이트
s3_data <- s3_data %>% select(-FROM)

#s3_data의 열 이름을 행 이름으로 설정
rownames(s3_data) <- colnames(s3_data)

# 데이터 프레임을 행렬로 변환
matrix_data <- as.matrix(s3_data)

# 결과 출력
print(matrix_data)
```

# 관계 시각화 1: Chord Diagram

## chordddiag

-   chord diagram은 관계를 시각화 하는 데 사용되는 그래프입니다.
-   chorddiag 패키지를 이용하여 chord diagram을 그릴 수 있습니다.

```{r, warning=FALSE}
#install.packages("devtools")
#library(devtools)
#devtools::install_github("mattflor/chorddiag", build_vignettes = TRUE)
library(chorddiag)
```

```{r, warning=FALSE}
# 사용자 정의 색상 지정

groupColors <- c("#02B2ED", #광태
                 "#F0A1D2", #다혜 
                 "#021EED", #동진
                 "#0268ED", #민형
                 "#ED0293", #상정
                 "#8502ED", #서경
                 "#ED0206", #유정
                 "#ED2A02", #종은
                 "#02EDDD", #주원
                 "#4790EF", #창진
                 "#D102ED", #혜원
                 "#3302ED") #휘현

# 코디어그램 생성
p <- chorddiag(matrix_data, groupColors = groupColors, groupnamePadding = 20)
# HTML 위젯으로 코디어그램 출력
p
```

# 텍스트 시각화 1: X편지

## 모든 커플의 편지 시각화

### 데이터 불러오기

```{r X편지 데이터 불러오기, warning=FALSE}
# 공유 가능한 URL을 사용하여 스프레드시트 데이터 불러오기

library(stringr)
#library(KoNLP)
library(wordcloud2)

url_mt <- "<https://docs.google.com/spreadsheets/d/168GPtSqLCr81j3yArZNpv2tecLNcnfZyRiMcWQ5zlPE/edit?usp=sharing>" 

df_mt <- read_sheet(url_mt)

df_mt$Value <- as.character(df_mt$Value)

df_mt <- as_tibble(df_mt)
```

### 전처리

-   bitNLP 라이브러리를 사용하여 형태소 분석을 수행합니다([Click](https://r2bit.com/bitNLP/)).

```{r X편지 라이브러리, warning=FALSE}
#remotes::install_github("bit2r/bitNLP")
library("bitNLP")
#install_mecab_ko()
#install.packages("RcppMeCab")
```

```{r X편지 전처리, warning=FALSE}
#특수문자 제거: 문자 혹은 공백 이외 것 제거 
df_mt <- df_mt %>% mutate(Value = str_remove_all(Value, "[^(\\w+|\\s)]"))

df_mt$Value <- enc2utf8(df_mt$Value)

library(tidytext)

#단어 단위로 분리
df_mt <- df_mt %>% 
  unnest_tokens(word, Value, "words")

#두 글자 이상만 남기기 
df_mt <- df_mt %>% filter(str_count(word) > 1)

df_mt$word %>% 
  morpho_mecab(indiv = FALSE)

docs <- c("님은 갔습니다. 아아, 사랑하는 나의 님은 갔습니다.",
          "푸른 산빛을 깨치고 단풍나무 숲을 향하여 난 작은 길을 걸어서, 차마 떨치고 갔습니다.")


df_mt %>% 
  count(word, sort = TRUE)
```

## 커플별로 살펴보기

### 혜원 - 휘현

-   휘현 to 혜원

    혜원이는 바라보기만 해도 기분이 좋아지는 미소를 가진 사람입니다. 첫인상은 참 따뜻하고 포근한데 성격은 더 따뜻하고 포근해요. 하나부터 열까지 남자친구에게 맞춰줬으며 싫은 소리 한 번 한 적 없습니다. 그런 혜원이가 화가 나거나 짜증이 났다는 건 정말 잘못했다는 거니까 싹싹 비셔야 할 거예요. 그리고 혜원이는 애정 표현과 칭찬을 정말 많이, 자주 해줘요. 그래서 같이 있으면 제가 참 괜찮은 사람처럼 느껴지게 해주죠. 실제로 혜원이 덕분에 자존감이 많이 올랐거든요.

    혜원이는 말 험하게 하는 걸 싫어해요. 욕하는 건 더더욱 안되고요. 근데 혜원이가 워낙 말을 예쁘게 하는 사람이라 같이 있다 보면 자연스레 물들어서 말을 예쁘게 하고 있을 거예요. 혜원이는 꼭 특별한 걸 같이 하지 않아도 잠깐 얼굴 보는 것만으로도 참 좋아해 줬어요. 사소한 것에도 크게 감동하고 고마워해 주는 사람인데 저는 그 사소한 것마저도 많이 해주지 못해서 참 마음 아프고 미안해요.

    혜원이가 이곳에서 상처받지 않고 좋은 추억만 가져갈 수 있었으면 좋겠어요. 이제는 혜원이가 기댈 수 있을 정도로 여유 있고, 단단하고, 멋있는 사람을 만났으면 좋겠습니다.

-   혜원 to 휘현

    어디서 빛이 난다 싶으면, 그곳에 휘현이가 있기 때문일 거예요. 하지만 휘현이는 겉모습만큼이나 속도 훈훈한 사람입니다. 저는 휘현이랑 함께하면 잠깐 편의점에서 보는 것만으로도 행복했거든요. 저는 휘현이를 만나면서 다정함과 배려를 많이 배웠습니다. 늘 저의 기분과 감정을 우선으로 헤아려주고, 웃게 해주는 남자친구였어요.

    휘현이는 노래 부르는 것을 좋아하고 자주 불러요. 그러나 자기만 부르는 건 싫어해요. 그러니 꼭 같이 불러주세요. 모든 것에 너그러워 보이지만 사실 거절을 잘 못하니 휘현이가 곤란하지 않게 배려해 주면서 다가가면 휘현이는 더 큰 행복을 줄 거예요.

    휘현이가 앞으로도 빛을 잃지 않게 휘현이를 믿고 지지해 줄 수 있는 사람을 만나 저와 하지 못했던 사랑을 하기를 바랍니다. '후회되는 건 휘현이가 너무 예뻐서 제가 휘현이만큼 예쁘지 못한 게 후회되네요.

```{r, echo=FALSE, warning=FALSE}
HWHH <- c("혜원이는 바라보기만 해도 기분이 좋아지는 미소를 가진 사람입니다. 첫인상은 참 따뜻하고 포근한데 성격은 더 따뜻하고 포근해요. 하나부터 열까지 남자친구에게 맞춰줬으며 싫은 소리 한 번 한 적 없습니다. 그런 혜원이가 화가 나거나 짜증이 났다는 건 정말 잘못했다는 거니까 싹싹 비셔야 할 거예요. 그리고 혜원이는 애정 표현과 칭찬을 정말 많이, 자주 해줘요. 그래서 같이 있으면 제가 참 괜찮은 사람처럼 느껴지게 해주죠. 실제로 혜원이 덕분에 자존감이 많이 올랐거든요.

    혜원이는 말 험하게 하는 걸 싫어해요. 욕하는 건 더더욱 안되고요. 근데 혜원이가 워낙 말을 예쁘게 하는 사람이라 같이 있다 보면 자연스레 물들어서 말을 예쁘게 하고 있을 거예요. 혜원이는 꼭 특별한 걸 같이 하지 않아도 잠깐 얼굴 보는 것만으로도 참 좋아해 줬어요. 사소한 것에도 크게 감동하고 고마워해 주는 사람인데 저는 그 사소한 것마저도 많이 해주지 못해서 참 마음 아프고 미안해요.

    혜원이가 이곳에서 상처받지 않고 좋은 추억만 가져갈 수 있었으면 좋겠어요. 이제는 혜원이가 기댈 수 있을 정도로 여유 있고, 단단하고, 멋있는 사람을 만났으면 좋겠습니다.", "어디서 빛이 난다 싶으면, 그곳에 휘현이가 있기 때문일 거예요.
    하지만 휘현이는 겉모습만큼이나 속도 훈훈한 사람입니다.
    저는 휘현이랑 함께하면 잠깐 편의점에서 보는 것만으로도 행복했거든요.
    저는 휘현이를 만나면서 다정함과 배려를 많이 배웠습니다.
    늘 저의 기분과 감정을 우선으로 헤아려주고, 웃게 해주는 남자친구였어요. 
    
    휘현이는 노래 부르는 것을 좋아하고 자주 불러요.
    그러나 자기만 부르는 건 싫어해요. 그러니 꼭 같이 불러주세요.
    모든 것에 너그러워 보이지만 사실 거절을 잘 못하니 휘현이가 곤란하지 않게 배려해 주면서 다가가면 휘현이는 더 큰 행복을 줄 거예요.
    
    휘현이가 앞으로도 빛을 잃지 않게 휘현이를 믿고 지지해 줄 수 있는 사람을 만나 저와 하지 못했던 사랑을 하기를 바랍니다. '후회되는 건 휘현이가 너무 예뻐서 제가 휘현이만큼 예쁘지 못한 게 후회되네요.")

dic_path <- system.file("dic", package = "bitNLP")
dic_file <- glue::glue("{dic_path}/buzz_dic.dic")
tokenize_noun_ngrams(HWHH, simplify = TRUE, user_dic = dic_file)

```

-   워드클라우드

```{r Wordcloud_HW, warning=FALSE}
# 혜원이 편지 워드클라우드

```

-   Chat GPT를 활용한 감정 점수

    -   휘현 -\> 혜원\
        이 편지를 분석하면, 사귈 당시 사랑했었던 감정은 매우 높았던 것으로 보입니다. 편지에서 묘사된 혜원에 대한 애정과 존중, 그리고 그녀의 행동과 성격에 대한 세심한 관찰은 매우 깊은 감정을 반영합니다. 편지 작성자는 혜원이 자신에게 긍정적인 영향을 미쳤다고 여기며, 그녀와의 관계를 매우 소중하게 생각했습니다.

        미련에 대한 감정 역시 높아 보입니다. 편지에서는 혜원에 대한 미안함과 그녀를 위한 바람, 그리고 이별 후에도 그녀가 좋은 사람과 만나기를 바라는 마음이 드러납니다. 이는 관계가 끝났음에도 불구하고 여전히 혜원에 대한 깊은 애정과 그녀의 행복을 바라는 마음을 보여줍니다.

        따라서, 사귈 당시 사랑했었던 감정과 미련에 대해 숫자로 표현한다면:

        | 감정                      | 점수 |
        |---------------------------|------|
        | 사귈 당시 사랑했었던 감정 | 90점 |
        | 미련                      | 85점 |

    -   혜원 -\> 휘현

        이 편지를 통해 보이는 감정은 휘현에 대한 깊은 애정과 그에 대한 존경, 그리고 미안함이 섞여 있습니다. 편지 작성자는 휘현이 자신의 삶에 긍정적인 변화를 가져왔으며, 그의 다정함과 배려를 배웠다고 언급합니다. 또한, 휘현이와 함께 보낸 순간들에서 큰 행복을 느꼈다고 말합니다.

        휘현이에 대한 이러한 감정 표현은 깊은 애정을 반영합니다. 휘현이가 사랑을 잘 표현하고, 배려심 깊은 사람이라는 점이 강조되며, 작성자는 이별 후에도 휘현이가 좋은 사람과 사랑을 나누길 바라는 마음을 표현합니다. 후회의 감정도 드러나는데, 이는 자신이 휘현이에 비해 부족하다고 느끼는 측면에서 오는 것으로 보입니다.

        이를 바탕으로 숫자로 표현한다면:

        | 감정                      | 점수 |
        |---------------------------|------|
        | 사귈 당시 사랑했었던 감정 | 92점 |
        | 미련                      | 80점 |

### 다혜 - 동진

-   다혜 to 동진

-   동진 to 다혜

-   워드클라우드

-   Chat GPT 의견

### 서경 - 주원

-   서경 to 주원
-   주원 to 서경
-   워드클라우드
-   Chat GPT 의견

### 유정- 창진

-   유정 to 창진
-   창진 to 유정
-   워드클라우드
-   Chat GPT 의견

### 상정 - 민형

-   민형 to 상정
-   워드클라우드
-   Chat GPT 의견

### 종은 - 광태

-   종은 to 광태
-   워드클라우드
-   Chat GPT 의견

# 텍스트 시각화 2: 속마음 메세지

# 설문조사 결과

## 각 출연자들에 대한 여론

### 이어졌으면 하는 커플은?

-   14화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

-   15화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

### 이어지지 않았으면 하는 커플은?

-   14화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

-   15화 공개 후 - 2024년 3월 00일 ㄱㄱ요일

# 참고 자료

## Chat GPT 활용

### Chat GPT를 활용한 감정 분석 및 점수화

-   Chat GPT 실제 채팅창 ([Click](https://chat.openai.com/share/77c1987c-548f-4cd7-90cd-4c580fcc8d7d))

    -   프롬프트 참고 -\> 넷마블 기술 블로그: Chat GPT를 활용해 정성적인 기대감을 정량적인 숫자로 바꿔보다 ([Click](https://netmarble.engineering/comment-metric-labeling-by-chatgpt/))
